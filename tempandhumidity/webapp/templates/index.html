{% extends "layout.html" %}

{% block body %}
<script>
    setInterval(myTimer, 1000);
    
    function myTimer() {
      const d = new Date();
      document.getElementById("demo").innerHTML = d.toLocaleTimeString();
    }
    
  // const mariadb = require('mariadb');
  // const pool = mariadb.createPool({
  //     host: 'localhost', 
  //     user:'frank', 
  //     password: 'password',
  //     database:'datalog',
  // });
  // console.log(pool)

  // async function asyncFunction() {
  //   let conn;
  //   try {
  //   conn = await pool.getConnection();
  //   const rows = await conn.query("SELECT * FROM thlog2 ORDER BY id DESC LIMIT 1");
  //   console.log(rows);

  //   } catch (err) {
  //   throw err;
  //   } finally {
  //   if (conn) return conn.end();
  //   }
  // }
</script>

<p id="demo" style="float: right;"></p>
<br>
<br>
<br>

<table class="table table-hover">
  <thead>
    <tr>
      <th scope="col"><div class="blob green" id=>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Live</div></th>
      <th scope="col">Temperature</th>
      <th scope="col">Humidity</th>
      <th scope="col">Timestamp</th>
    </tr>
  </thead>
  
  <tbody>

  {% for item in cur %}
    <tr>
      <th scope="row">1</th>
      <td>{{ item[0] }}</td>
      <td>{{item[1]}}</td>
      <td>{{item[0] }}</td>
    </tr>
  {% endfor %}
  </tbody>
</table>

<br>
<br>

<br>
<br>
<form action="/date" method="post">
    <label>From</label>
    <input autocomplete="off" autofocus name="date"  type="datetime-local" required="true"  min="2022-05-27T00:00" >
    <label>to</label>
    <input autocomplete="off" autofocus name="date2"  type="datetime-local" required="true" max="2022-05-27T12:00">
    <p></p>
    <select name="data" required="true">
        <option disabled selected value="">Data</option>
        <option value="Temperature">Temperature</option>
        <option value="Humidity">Humidity</option>
    </select>
    <select name="calculate" required="true">
        <option disabled selected value="">Calculate</option>
        <option value="Average">Average</option>
        <option value="Mininimum">Mininimum</option>
        <option value="Maximum">Maximum</option>
    </select>
    <input type="submit" value="Analyze">

</form>

<br>
<br>
<br>
<br>
<h2>Data Analysis</h2>
<table class="table table-hover">
    <thead>
      <tr>
        <th scope="col">Recent Data</th>
        <th scope="col">Temperature</th>
        <th scope="col">Timestamp</th>
      </tr>
    </thead>
    <tbody>
    {% for item in cur %}
      <tr>
        <th scope="row">1</th>
        <td>{{ item[0] }}</td>
        <td>{{item[1]}}</td>
      </tr>
    {% endfor %}
    </tbody>
  </table>

{% endblock %}